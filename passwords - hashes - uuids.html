<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CryptoGen — Hashes · Passwords · UUIDs</title>
<link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@300;400;500;600;700&family=DM+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
  :root {
    --bg: #0c0e12;
    --surface: #13161c;
    --surface-raised: #1a1e26;
    --border: #252a34;
    --border-hover: #3a4154;
    --text: #e2e6ef;
    --text-muted: #6b7394;
    --accent: #38bdf8;
    --accent-dim: rgba(56, 189, 248, 0.12);
    --accent-glow: rgba(56, 189, 248, 0.25);
    --green: #4ade80;
    --green-dim: rgba(74, 222, 128, 0.12);
    --amber: #fbbf24;
    --amber-dim: rgba(251, 191, 36, 0.12);
    --red: #f87171;
    --red-dim: rgba(248, 113, 113, 0.12);
    --purple: #a78bfa;
    --purple-dim: rgba(167, 139, 250, 0.12);
    --radius: 10px;
    --radius-sm: 6px;
  }

  * { margin: 0; padding: 0; box-sizing: border-box; }

  body {
    font-family: 'DM Sans', sans-serif;
    background: var(--bg);
    color: var(--text);
    min-height: 100vh;
    overflow-x: hidden;
  }

  /* Subtle grid background */
  body::before {
    content: '';
    position: fixed;
    inset: 0;
    background-image:
      linear-gradient(rgba(56, 189, 248, 0.03) 1px, transparent 1px),
      linear-gradient(90deg, rgba(56, 189, 248, 0.03) 1px, transparent 1px);
    background-size: 60px 60px;
    pointer-events: none;
    z-index: 0;
  }

  .app {
    position: relative;
    z-index: 1;
    max-width: 900px;
    margin: 0 auto;
    padding: 40px 24px 80px;
  }

  /* Header */
  .header {
    text-align: center;
    margin-bottom: 48px;
    animation: fadeIn 0.6s ease;
  }

  .header .badge {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    font-family: 'JetBrains Mono', monospace;
    font-size: 11px;
    font-weight: 500;
    letter-spacing: 1.5px;
    text-transform: uppercase;
    color: var(--accent);
    background: var(--accent-dim);
    border: 1px solid rgba(56, 189, 248, 0.2);
    padding: 6px 14px;
    border-radius: 20px;
    margin-bottom: 16px;
  }

  .header h1 {
    font-family: 'JetBrains Mono', monospace;
    font-size: 32px;
    font-weight: 700;
    letter-spacing: -0.5px;
    margin-bottom: 8px;
    background: linear-gradient(135deg, #e2e6ef 0%, #6b7394 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
  }

  .header p {
    color: var(--text-muted);
    font-size: 15px;
  }

  /* Tabs */
  .tabs {
    display: flex;
    gap: 4px;
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    padding: 4px;
    margin-bottom: 32px;
    animation: fadeIn 0.6s ease 0.1s both;
  }

  .tab {
    flex: 1;
    padding: 12px 16px;
    border: none;
    background: transparent;
    color: var(--text-muted);
    font-family: 'JetBrains Mono', monospace;
    font-size: 13px;
    font-weight: 500;
    cursor: pointer;
    border-radius: var(--radius-sm);
    transition: all 0.25s ease;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
  }

  .tab:hover { color: var(--text); background: var(--surface-raised); }

  .tab.active {
    background: var(--surface-raised);
    color: var(--accent);
    box-shadow: 0 0 0 1px var(--border-hover), 0 2px 8px rgba(0,0,0,0.2);
  }

  .tab svg { width: 16px; height: 16px; }

  /* Panels */
  .panel { display: none; animation: fadeIn 0.35s ease; }
  .panel.active { display: block; }

  .card {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    padding: 28px;
    margin-bottom: 20px;
    animation: slideUp 0.4s ease;
  }

  .card-title {
    font-family: 'JetBrains Mono', monospace;
    font-size: 12px;
    font-weight: 600;
    letter-spacing: 1px;
    text-transform: uppercase;
    color: var(--text-muted);
    margin-bottom: 20px;
  }

  /* Form elements */
  .field { margin-bottom: 18px; }

  .field label {
    display: block;
    font-size: 13px;
    font-weight: 500;
    color: var(--text-muted);
    margin-bottom: 6px;
  }

  .input-wrap {
    position: relative;
  }

  input[type="text"], input[type="number"], textarea, select {
    width: 100%;
    padding: 11px 14px;
    background: var(--bg);
    border: 1px solid var(--border);
    border-radius: var(--radius-sm);
    color: var(--text);
    font-family: 'JetBrains Mono', monospace;
    font-size: 13px;
    outline: none;
    transition: border-color 0.2s, box-shadow 0.2s;
  }

  input:focus, textarea:focus, select:focus {
    border-color: var(--accent);
    box-shadow: 0 0 0 3px var(--accent-dim);
  }

  textarea { resize: vertical; min-height: 80px; }

  select {
    appearance: none;
    cursor: pointer;
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='%236b7394' viewBox='0 0 16 16'%3E%3Cpath d='M4 6l4 4 4-4'/%3E%3C/svg%3E");
    background-repeat: no-repeat;
    background-position: right 12px center;
    padding-right: 36px;
  }

  /* Checkbox / toggle row */
  .toggle-row {
    display: flex;
    flex-wrap: wrap;
    gap: 12px;
    margin-bottom: 18px;
  }

  .toggle-item {
    display: flex;
    align-items: center;
    gap: 8px;
    cursor: pointer;
    font-size: 13px;
    color: var(--text-muted);
    user-select: none;
  }

  .toggle-item input[type="checkbox"] {
    appearance: none;
    width: 18px;
    height: 18px;
    border: 1.5px solid var(--border-hover);
    border-radius: 4px;
    background: var(--bg);
    cursor: pointer;
    position: relative;
    transition: all 0.2s;
    flex-shrink: 0;
  }

  .toggle-item input[type="checkbox"]:checked {
    background: var(--accent);
    border-color: var(--accent);
  }

  .toggle-item input[type="checkbox"]:checked::after {
    content: '';
    position: absolute;
    left: 5px; top: 2px;
    width: 5px; height: 9px;
    border: solid var(--bg);
    border-width: 0 2px 2px 0;
    transform: rotate(45deg);
  }

  /* Range slider */
  .range-row {
    display: flex;
    align-items: center;
    gap: 14px;
  }

  .range-row input[type="range"] {
    flex: 1;
    appearance: none;
    height: 6px;
    background: var(--border);
    border-radius: 3px;
    outline: none;
  }

  .range-row input[type="range"]::-webkit-slider-thumb {
    appearance: none;
    width: 18px; height: 18px;
    background: var(--accent);
    border-radius: 50%;
    cursor: pointer;
    box-shadow: 0 0 8px var(--accent-glow);
  }

  .range-value {
    font-family: 'JetBrains Mono', monospace;
    font-size: 14px;
    font-weight: 600;
    color: var(--accent);
    min-width: 32px;
    text-align: center;
  }

  /* Buttons */
  .btn-row {
    display: flex;
    gap: 10px;
    flex-wrap: wrap;
  }

  .btn {
    display: inline-flex;
    align-items: center;
    gap: 8px;
    padding: 11px 22px;
    border: none;
    border-radius: var(--radius-sm);
    font-family: 'DM Sans', sans-serif;
    font-size: 14px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s;
  }

  .btn svg { width: 16px; height: 16px; }

  .btn-primary {
    background: var(--accent);
    color: var(--bg);
  }
  .btn-primary:hover {
    background: #60ccfc;
    box-shadow: 0 4px 16px var(--accent-glow);
    transform: translateY(-1px);
  }

  .btn-secondary {
    background: var(--surface-raised);
    color: var(--text-muted);
    border: 1px solid var(--border);
  }
  .btn-secondary:hover {
    color: var(--text);
    border-color: var(--border-hover);
  }

  /* Output area */
  .output-box {
    position: relative;
    margin-top: 20px;
  }

  .output-label {
    font-size: 12px;
    font-weight: 600;
    letter-spacing: 0.8px;
    text-transform: uppercase;
    color: var(--text-muted);
    margin-bottom: 8px;
    font-family: 'JetBrains Mono', monospace;
  }

  .output-value {
    background: var(--bg);
    border: 1px solid var(--border);
    border-radius: var(--radius-sm);
    padding: 14px 48px 14px 16px;
    font-family: 'JetBrains Mono', monospace;
    font-size: 13px;
    line-height: 1.6;
    word-break: break-all;
    color: var(--green);
    min-height: 48px;
    position: relative;
  }

  .output-value.empty { color: var(--text-muted); font-style: italic; }

  .copy-btn {
    position: absolute;
    top: 10px; right: 10px;
    background: var(--surface-raised);
    border: 1px solid var(--border);
    color: var(--text-muted);
    padding: 6px 8px;
    border-radius: 5px;
    cursor: pointer;
    transition: all 0.2s;
    display: flex;
    align-items: center;
    gap: 4px;
    font-family: 'JetBrains Mono', monospace;
    font-size: 11px;
  }

  .copy-btn:hover { color: var(--text); border-color: var(--border-hover); }
  .copy-btn.copied { color: var(--green); border-color: var(--green); }
  .copy-btn svg { width: 14px; height: 14px; }

  /* Hash multi-output */
  .hash-results { display: flex; flex-direction: column; gap: 12px; margin-top: 20px; }

  .hash-item {
    display: grid;
    grid-template-columns: 90px 1fr auto;
    gap: 12px;
    align-items: start;
    padding: 12px 14px;
    background: var(--bg);
    border: 1px solid var(--border);
    border-radius: var(--radius-sm);
  }

  .hash-item .algo {
    font-family: 'JetBrains Mono', monospace;
    font-size: 11px;
    font-weight: 600;
    color: var(--purple);
    text-transform: uppercase;
    letter-spacing: 0.5px;
    padding-top: 2px;
  }

  .hash-item .value {
    font-family: 'JetBrains Mono', monospace;
    font-size: 12px;
    color: var(--text);
    word-break: break-all;
    line-height: 1.5;
  }

  .hash-item .copy-inline {
    background: none;
    border: none;
    color: var(--text-muted);
    cursor: pointer;
    padding: 2px;
    transition: color 0.2s;
    flex-shrink: 0;
  }
  .hash-item .copy-inline:hover { color: var(--accent); }
  .hash-item .copy-inline.copied { color: var(--green); }
  .hash-item .copy-inline svg { width: 14px; height: 14px; }

  /* Password strength meter */
  .strength-meter {
    margin-top: 12px;
    display: flex;
    align-items: center;
    gap: 12px;
  }

  .strength-bar {
    flex: 1;
    height: 4px;
    background: var(--border);
    border-radius: 2px;
    overflow: hidden;
  }

  .strength-fill {
    height: 100%;
    border-radius: 2px;
    transition: width 0.4s ease, background 0.4s ease;
  }

  .strength-label {
    font-family: 'JetBrains Mono', monospace;
    font-size: 11px;
    font-weight: 600;
    letter-spacing: 0.5px;
    min-width: 70px;
    text-align: right;
  }

  /* UUID batch */
  .uuid-list {
    display: flex;
    flex-direction: column;
    gap: 6px;
    margin-top: 20px;
  }

  .uuid-item {
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 10px 14px;
    background: var(--bg);
    border: 1px solid var(--border);
    border-radius: var(--radius-sm);
    font-family: 'JetBrains Mono', monospace;
    font-size: 13px;
    color: var(--amber);
  }

  .uuid-item .num {
    color: var(--text-muted);
    font-size: 11px;
    min-width: 20px;
  }

  .uuid-item .val { flex: 1; word-break: break-all; }

  .uuid-item .copy-inline {
    background: none;
    border: none;
    color: var(--text-muted);
    cursor: pointer;
    padding: 2px;
    transition: color 0.2s;
  }
  .uuid-item .copy-inline:hover { color: var(--accent); }
  .uuid-item .copy-inline.copied { color: var(--green); }
  .uuid-item .copy-inline svg { width: 14px; height: 14px; }

  /* Animations */
  @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
  @keyframes slideUp { from { opacity: 0; transform: translateY(12px); } to { opacity: 1; transform: translateY(0); } }

  .flash {
    animation: flash 0.3s ease;
  }
  @keyframes flash {
    0% { background: var(--accent-dim); }
    100% { background: var(--bg); }
  }

  /* Responsive */
  @media (max-width: 600px) {
    .app { padding: 24px 16px 60px; }
    .header h1 { font-size: 24px; }
    .card { padding: 20px; }
    .hash-item { grid-template-columns: 70px 1fr auto; }
    .hash-item .algo { font-size: 10px; }
    .hash-item .value { font-size: 11px; }
    .tab { font-size: 11px; padding: 10px 8px; }
  }
</style>
</head>
<body>

<div class="app">
  <header class="header">
    <div class="badge">⚡ Client-Side Only</div>
    <h1>CryptoGen</h1>
    <p>Generate hashes, passwords, and UUIDs — nothing leaves your browser</p>
  </header>

  <div class="tabs">
    <button class="tab active" data-tab="hash" onclick="switchTab('hash')">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 9h16M4 15h16M10 3v18M14 3v18"/></svg>
      Hashes
    </button>
    <button class="tab" data-tab="password" onclick="switchTab('password')">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="11" width="18" height="11" rx="2"/><path d="M7 11V7a5 5 0 0110 0v4"/></svg>
      Passwords
    </button>
    <button class="tab" data-tab="uuid" onclick="switchTab('uuid')">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="7" height="7" rx="1"/><rect x="14" y="3" width="7" height="7" rx="1"/><rect x="3" y="14" width="7" height="7" rx="1"/><rect x="14" y="14" width="7" height="7" rx="1"/></svg>
      UUIDs
    </button>
  </div>

  <!-- HASH PANEL -->
  <div class="panel active" id="panel-hash">
    <div class="card">
      <div class="card-title">Input</div>
      <div class="field">
        <label>Text to hash</label>
        <textarea id="hashInput" placeholder="Enter text to generate hashes..."></textarea>
      </div>
      <div class="field">
        <label>Encoding</label>
        <select id="hashEncoding">
          <option value="hex">Hexadecimal</option>
          <option value="base64">Base64</option>
        </select>
      </div>
      <div class="btn-row">
        <button class="btn btn-primary" onclick="generateHashes()">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 9h16M4 15h16M10 3v18M14 3v18"/></svg>
          Generate Hashes
        </button>
        <button class="btn btn-secondary" onclick="clearHash()">Clear</button>
      </div>
    </div>
    <div id="hashResults"></div>
  </div>

  <!-- PASSWORD PANEL -->
  <div class="panel" id="panel-password">
    <div class="card">
      <div class="card-title">Configuration</div>
      <div class="field">
        <label>Length</label>
        <div class="range-row">
          <input type="range" id="pwLength" min="4" max="128" value="24" oninput="updatePwLength()">
          <span class="range-value" id="pwLengthVal">24</span>
        </div>
      </div>
      <div class="field">
        <label>Character Sets</label>
        <div class="toggle-row">
          <label class="toggle-item"><input type="checkbox" id="pwUpper" checked> Uppercase (A-Z)</label>
          <label class="toggle-item"><input type="checkbox" id="pwLower" checked> Lowercase (a-z)</label>
          <label class="toggle-item"><input type="checkbox" id="pwDigits" checked> Digits (0-9)</label>
          <label class="toggle-item"><input type="checkbox" id="pwSymbols" checked> Symbols (!@#$...)</label>
        </div>
      </div>
      <div class="field">
        <label>Exclude ambiguous characters (0, O, l, 1, I)</label>
        <div class="toggle-row">
          <label class="toggle-item"><input type="checkbox" id="pwExcludeAmbiguous"> Exclude</label>
        </div>
      </div>
      <div class="field">
        <label>Count</label>
        <div class="range-row">
          <input type="range" id="pwCount" min="1" max="20" value="1" oninput="updatePwCount()">
          <span class="range-value" id="pwCountVal">1</span>
        </div>
      </div>
      <div class="btn-row">
        <button class="btn btn-primary" onclick="generatePasswords()">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="11" width="18" height="11" rx="2"/><path d="M7 11V7a5 5 0 0110 0v4"/></svg>
          Generate Password
        </button>
      </div>
    </div>
    <div id="pwResults"></div>
  </div>

  <!-- UUID PANEL -->
  <div class="panel" id="panel-uuid">
    <div class="card">
      <div class="card-title">Configuration</div>
      <div class="field">
        <label>Version</label>
        <select id="uuidVersion">
          <option value="4">v4 — Random</option>
          <option value="7">v7 — Time-ordered (sortable)</option>
        </select>
      </div>
      <div class="field">
        <label>Format</label>
        <select id="uuidFormat">
          <option value="standard">Standard (with dashes)</option>
          <option value="nodash">No dashes</option>
          <option value="upper">Uppercase</option>
          <option value="braces">With braces {…}</option>
          <option value="urn">URN (urn:uuid:…)</option>
        </select>
      </div>
      <div class="field">
        <label>Count</label>
        <div class="range-row">
          <input type="range" id="uuidCount" min="1" max="50" value="5" oninput="updateUuidCount()">
          <span class="range-value" id="uuidCountVal">5</span>
        </div>
      </div>
      <div class="btn-row">
        <button class="btn btn-primary" onclick="generateUuids()">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="7" height="7" rx="1"/><rect x="14" y="3" width="7" height="7" rx="1"/><rect x="3" y="14" width="7" height="7" rx="1"/><rect x="14" y="14" width="7" height="7" rx="1"/></svg>
          Generate UUIDs
        </button>
        <button class="btn btn-secondary" onclick="copyAllUuids()">Copy All</button>
      </div>
    </div>
    <div id="uuidResults"></div>
  </div>
</div>

<script>
const copyIcon = `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"/></svg>`;
const checkIcon = `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20 6L9 17l-5-5"/></svg>`;

// Tab switching
function switchTab(tab) {
  document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
  document.querySelectorAll('.panel').forEach(p => p.classList.remove('active'));
  document.querySelector(`[data-tab="${tab}"]`).classList.add('active');
  document.getElementById(`panel-${tab}`).classList.add('active');
}

// Copy helper
async function copyText(text, btn) {
  await navigator.clipboard.writeText(text);
  btn.classList.add('copied');
  const orig = btn.innerHTML;
  btn.innerHTML = checkIcon + ' Copied';
  setTimeout(() => { btn.classList.remove('copied'); btn.innerHTML = orig; }, 1500);
}

async function copyInline(text, btn) {
  await navigator.clipboard.writeText(text);
  btn.classList.add('copied');
  btn.innerHTML = checkIcon;
  setTimeout(() => { btn.classList.remove('copied'); btn.innerHTML = copyIcon; }, 1200);
}

// ==================== HASHES ====================
async function computeHash(algo, text, encoding) {
  const data = new TextEncoder().encode(text);
  const hashBuffer = await crypto.subtle.digest(algo, data);
  const hashArray = new Uint8Array(hashBuffer);
  if (encoding === 'base64') {
    return btoa(String.fromCharCode(...hashArray));
  }
  return Array.from(hashArray).map(b => b.toString(16).padStart(2, '0')).join('');
}

async function generateHashes() {
  const text = document.getElementById('hashInput').value;
  if (!text) return;
  const encoding = document.getElementById('hashEncoding').value;

  const algos = [
    { name: 'MD5', algo: null },
    { name: 'SHA-1', algo: 'SHA-1' },
    { name: 'SHA-256', algo: 'SHA-256' },
    { name: 'SHA-384', algo: 'SHA-384' },
    { name: 'SHA-512', algo: 'SHA-512' },
  ];

  let html = '<div class="hash-results">';
  for (const a of algos) {
    let hash;
    if (a.name === 'MD5') {
      hash = md5(text, encoding);
    } else {
      hash = await computeHash(a.algo, text, encoding);
    }
    html += `
      <div class="hash-item">
        <div class="algo">${a.name}</div>
        <div class="value">${hash}</div>
        <button class="copy-inline" onclick="copyInline('${hash}', this)">${copyIcon}</button>
      </div>`;
  }
  html += '</div>';
  document.getElementById('hashResults').innerHTML = html;
}

function clearHash() {
  document.getElementById('hashInput').value = '';
  document.getElementById('hashResults').innerHTML = '';
}

// Simple MD5 implementation
function md5(string, encoding) {
  function md5cycle(x, k) {
    var a = x[0], b = x[1], c = x[2], d = x[3];
    a = ff(a, b, c, d, k[0], 7, -680876936); d = ff(d, a, b, c, k[1], 12, -389564586);
    c = ff(c, d, a, b, k[2], 17, 606105819); b = ff(b, c, d, a, k[3], 22, -1044525330);
    a = ff(a, b, c, d, k[4], 7, -176418897); d = ff(d, a, b, c, k[5], 12, 1200080426);
    c = ff(c, d, a, b, k[6], 17, -1473231341); b = ff(b, c, d, a, k[7], 22, -45705983);
    a = ff(a, b, c, d, k[8], 7, 1770035416); d = ff(d, a, b, c, k[9], 12, -1958414417);
    c = ff(c, d, a, b, k[10], 17, -42063); b = ff(b, c, d, a, k[11], 22, -1990404162);
    a = ff(a, b, c, d, k[12], 7, 1804603682); d = ff(d, a, b, c, k[13], 12, -40341101);
    c = ff(c, d, a, b, k[14], 17, -1502002290); b = ff(b, c, d, a, k[15], 22, 1236535329);
    a = gg(a, b, c, d, k[1], 5, -165796510); d = gg(d, a, b, c, k[6], 9, -1069501632);
    c = gg(c, d, a, b, k[11], 14, 643717713); b = gg(b, c, d, a, k[0], 20, -373897302);
    a = gg(a, b, c, d, k[5], 5, -701558691); d = gg(d, a, b, c, k[10], 9, 38016083);
    c = gg(c, d, a, b, k[15], 14, -660478335); b = gg(b, c, d, a, k[4], 20, -405537848);
    a = gg(a, b, c, d, k[9], 5, 568446438); d = gg(d, a, b, c, k[14], 9, -1019803690);
    c = gg(c, d, a, b, k[3], 14, -187363961); b = gg(b, c, d, a, k[8], 20, 1163531501);
    a = gg(a, b, c, d, k[13], 5, -1444681467); d = gg(d, a, b, c, k[2], 9, -51403784);
    c = gg(c, d, a, b, k[7], 14, 1735328473); b = gg(b, c, d, a, k[12], 20, -1926607734);
    a = hh(a, b, c, d, k[5], 4, -378558); d = hh(d, a, b, c, k[8], 11, -2022574463);
    c = hh(c, d, a, b, k[11], 16, 1839030562); b = hh(b, c, d, a, k[14], 23, -35309556);
    a = hh(a, b, c, d, k[1], 4, -1530992060); d = hh(d, a, b, c, k[4], 11, 1272893353);
    c = hh(c, d, a, b, k[7], 16, -155497632); b = hh(b, c, d, a, k[10], 23, -1094730640);
    a = hh(a, b, c, d, k[13], 4, 681279174); d = hh(d, a, b, c, k[0], 11, -358537222);
    c = hh(c, d, a, b, k[3], 16, -722521979); b = hh(b, c, d, a, k[6], 23, 76029189);
    a = hh(a, b, c, d, k[9], 4, -640364487); d = hh(d, a, b, c, k[12], 11, -421815835);
    c = hh(c, d, a, b, k[15], 16, 530742520); b = hh(b, c, d, a, k[2], 23, -995338651);
    a = ii(a, b, c, d, k[0], 6, -198630844); d = ii(d, a, b, c, k[7], 10, 1126891415);
    c = ii(c, d, a, b, k[14], 15, -1416354905); b = ii(b, c, d, a, k[5], 21, -57434055);
    a = ii(a, b, c, d, k[12], 6, 1700485571); d = ii(d, a, b, c, k[3], 10, -1894986606);
    c = ii(c, d, a, b, k[10], 15, -1051523); b = ii(b, c, d, a, k[1], 21, -2054922799);
    a = ii(a, b, c, d, k[8], 6, 1873313359); d = ii(d, a, b, c, k[15], 10, -30611744);
    c = ii(c, d, a, b, k[6], 15, -1560198380); b = ii(b, c, d, a, k[13], 21, 1309151649);
    a = ii(a, b, c, d, k[4], 6, -145523070); d = ii(d, a, b, c, k[11], 10, -1120210379);
    c = ii(c, d, a, b, k[2], 15, 718787259); b = ii(b, c, d, a, k[9], 21, -343485551);
    x[0] = add32(a, x[0]); x[1] = add32(b, x[1]); x[2] = add32(c, x[2]); x[3] = add32(d, x[3]);
  }
  function cmn(q, a, b, x, s, t) { a = add32(add32(a, q), add32(x, t)); return add32((a << s) | (a >>> (32 - s)), b); }
  function ff(a, b, c, d, x, s, t) { return cmn((b & c) | ((~b) & d), a, b, x, s, t); }
  function gg(a, b, c, d, x, s, t) { return cmn((b & d) | (c & (~d)), a, b, x, s, t); }
  function hh(a, b, c, d, x, s, t) { return cmn(b ^ c ^ d, a, b, x, s, t); }
  function ii(a, b, c, d, x, s, t) { return cmn(c ^ (b | (~d)), a, b, x, s, t); }
  function md51(s) {
    var n = s.length, state = [1732584193, -271733879, -1732584194, 271733878], i;
    for (i = 64; i <= n; i += 64) md5cycle(state, md5blk(s.substring(i - 64, i)));
    s = s.substring(i - 64);
    var tail = [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];
    for (i = 0; i < s.length; i++) tail[i >> 2] |= s.charCodeAt(i) << ((i % 4) << 3);
    tail[i >> 2] |= 0x80 << ((i % 4) << 3);
    if (i > 55) { md5cycle(state, tail); for (i = 0; i < 16; i++) tail[i] = 0; }
    tail[14] = n * 8;
    md5cycle(state, tail);
    return state;
  }
  function md5blk(s) {
    var md5blks = [], i;
    for (i = 0; i < 64; i += 4) md5blks[i >> 2] = s.charCodeAt(i) + (s.charCodeAt(i+1) << 8) + (s.charCodeAt(i+2) << 16) + (s.charCodeAt(i+3) << 24);
    return md5blks;
  }
  function add32(a, b) { return (a + b) & 0xFFFFFFFF; }
  function rhex(n) {
    var s = '', j;
    for (j = 0; j < 4; j++) s += '0123456789abcdef'.charAt((n >> (j * 8 + 4)) & 0x0f) + '0123456789abcdef'.charAt((n >> (j * 8)) & 0x0f);
    return s;
  }
  var raw = md51(string);
  if (encoding === 'base64') {
    var bytes = [];
    for (var i = 0; i < 4; i++) for (var j = 0; j < 4; j++) bytes.push((raw[i] >> (j * 8)) & 0xFF);
    return btoa(String.fromCharCode(...bytes));
  }
  return rhex(raw[0]) + rhex(raw[1]) + rhex(raw[2]) + rhex(raw[3]);
}

// ==================== PASSWORDS ====================
function updatePwLength() {
  document.getElementById('pwLengthVal').textContent = document.getElementById('pwLength').value;
}
function updatePwCount() {
  document.getElementById('pwCountVal').textContent = document.getElementById('pwCount').value;
}

function generatePassword(length, upper, lower, digits, symbols, excludeAmbiguous) {
  let chars = '';
  const ambiguous = '0OlI1';
  if (upper) chars += 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
  if (lower) chars += 'abcdefghijklmnopqrstuvwxyz';
  if (digits) chars += '0123456789';
  if (symbols) chars += '!@#$%^&*()_+-=[]{}|;:,.<>?';
  if (!chars) return '';
  if (excludeAmbiguous) chars = chars.split('').filter(c => !ambiguous.includes(c)).join('');
  const arr = new Uint32Array(length);
  crypto.getRandomValues(arr);
  return Array.from(arr, v => chars[v % chars.length]).join('');
}

function getStrength(pw) {
  let score = 0;
  if (pw.length >= 8) score++;
  if (pw.length >= 16) score++;
  if (pw.length >= 24) score++;
  if (/[a-z]/.test(pw) && /[A-Z]/.test(pw)) score++;
  if (/\d/.test(pw)) score++;
  if (/[^a-zA-Z0-9]/.test(pw)) score++;
  if (pw.length >= 32) score++;
  if (score <= 2) return { label: 'Weak', color: 'var(--red)', pct: 25 };
  if (score <= 4) return { label: 'Fair', color: 'var(--amber)', pct: 50 };
  if (score <= 5) return { label: 'Strong', color: 'var(--accent)', pct: 75 };
  return { label: 'Excellent', color: 'var(--green)', pct: 100 };
}

function generatePasswords() {
  const length = parseInt(document.getElementById('pwLength').value);
  const upper = document.getElementById('pwUpper').checked;
  const lower = document.getElementById('pwLower').checked;
  const digits = document.getElementById('pwDigits').checked;
  const symbols = document.getElementById('pwSymbols').checked;
  const exclude = document.getElementById('pwExcludeAmbiguous').checked;
  const count = parseInt(document.getElementById('pwCount').value);

  if (!upper && !lower && !digits && !symbols) {
    document.getElementById('pwResults').innerHTML = '<div class="card" style="color:var(--red);">Select at least one character set.</div>';
    return;
  }

  let html = '';
  for (let i = 0; i < count; i++) {
    const pw = generatePassword(length, upper, lower, digits, symbols, exclude);
    const str = getStrength(pw);
    html += `
      <div class="card">
        <div class="output-box">
          <div class="output-label">${count > 1 ? `Password ${i+1}` : 'Generated Password'}</div>
          <div class="output-value" style="color: var(--green);">${escapeHtml(pw)}
            <button class="copy-btn" onclick="copyText('${escapeAttr(pw)}', this)">${copyIcon} Copy</button>
          </div>
          <div class="strength-meter">
            <div class="strength-bar"><div class="strength-fill" style="width:${str.pct}%;background:${str.color}"></div></div>
            <div class="strength-label" style="color:${str.color}">${str.label}</div>
          </div>
        </div>
      </div>`;
  }
  document.getElementById('pwResults').innerHTML = html;
}

function escapeHtml(s) { return s.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;'); }
function escapeAttr(s) { return s.replace(/\\/g,'\\\\').replace(/'/g,"\\'").replace(/"/g,'\\"'); }

// ==================== UUIDs ====================
function updateUuidCount() {
  document.getElementById('uuidCountVal').textContent = document.getElementById('uuidCount').value;
}

function uuidv4() {
  const bytes = new Uint8Array(16);
  crypto.getRandomValues(bytes);
  bytes[6] = (bytes[6] & 0x0f) | 0x40;
  bytes[8] = (bytes[8] & 0x3f) | 0x80;
  const hex = Array.from(bytes).map(b => b.toString(16).padStart(2, '0')).join('');
  return `${hex.slice(0,8)}-${hex.slice(8,12)}-${hex.slice(12,16)}-${hex.slice(16,20)}-${hex.slice(20)}`;
}

function uuidv7() {
  const now = Date.now();
  const bytes = new Uint8Array(16);
  crypto.getRandomValues(bytes);
  // timestamp (48 bits)
  const ts = BigInt(now);
  bytes[0] = Number((ts >> 40n) & 0xFFn);
  bytes[1] = Number((ts >> 32n) & 0xFFn);
  bytes[2] = Number((ts >> 24n) & 0xFFn);
  bytes[3] = Number((ts >> 16n) & 0xFFn);
  bytes[4] = Number((ts >> 8n) & 0xFFn);
  bytes[5] = Number(ts & 0xFFn);
  bytes[6] = (bytes[6] & 0x0f) | 0x70;
  bytes[8] = (bytes[8] & 0x3f) | 0x80;
  const hex = Array.from(bytes).map(b => b.toString(16).padStart(2, '0')).join('');
  return `${hex.slice(0,8)}-${hex.slice(8,12)}-${hex.slice(12,16)}-${hex.slice(16,20)}-${hex.slice(20)}`;
}

function formatUuid(uuid, format) {
  switch (format) {
    case 'nodash': return uuid.replace(/-/g, '');
    case 'upper': return uuid.toUpperCase();
    case 'braces': return `{${uuid}}`;
    case 'urn': return `urn:uuid:${uuid}`;
    default: return uuid;
  }
}

let lastUuids = [];

function generateUuids() {
  const version = document.getElementById('uuidVersion').value;
  const format = document.getElementById('uuidFormat').value;
  const count = parseInt(document.getElementById('uuidCount').value);

  lastUuids = [];
  let html = '<div class="uuid-list">';
  for (let i = 0; i < count; i++) {
    const raw = version === '7' ? uuidv7() : uuidv4();
    const formatted = formatUuid(raw, format);
    lastUuids.push(formatted);
    html += `
      <div class="uuid-item">
        <span class="num">${i+1}</span>
        <span class="val">${formatted}</span>
        <button class="copy-inline" onclick="copyInline('${formatted}', this)">${copyIcon}</button>
      </div>`;
  }
  html += '</div>';
  document.getElementById('uuidResults').innerHTML = html;
}

async function copyAllUuids() {
  if (!lastUuids.length) { generateUuids(); }
  await navigator.clipboard.writeText(lastUuids.join('\n'));
}

// Generate initial results on load
generatePasswords();
generateUuids();
</script>
</body>
</html>
