<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dict ⇄ JSON Converter</title>
<link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;600;700&family=DM+Sans:wght@400;500;700&display=swap" rel="stylesheet">
<style>
  :root {
    --bg: #0f1117;
    --surface: #181a24;
    --surface-hover: #1e2130;
    --border: #2a2d3e;
    --border-focus: #5b8def;
    --text: #e1e4ed;
    --text-dim: #6b7194;
    --accent-blue: #5b8def;
    --accent-green: #4ade80;
    --accent-amber: #fbbf24;
    --accent-red: #f87171;
    --py-color: #3b82f6;
    --json-color: #f59e0b;
    --mono: 'JetBrains Mono', monospace;
    --sans: 'DM Sans', sans-serif;
    --radius: 12px;
    --shadow: 0 4px 24px rgba(0,0,0,0.3);
  }

  * { margin: 0; padding: 0; box-sizing: border-box; }

  body {
    font-family: var(--sans);
    background: var(--bg);
    color: var(--text);
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 2rem 1.5rem;
    background-image:
      radial-gradient(ellipse at 20% 0%, rgba(59,130,246,0.06) 0%, transparent 60%),
      radial-gradient(ellipse at 80% 100%, rgba(245,158,11,0.06) 0%, transparent 60%);
  }

  header {
    text-align: center;
    margin-bottom: 2rem;
    animation: fadeDown 0.5s ease-out;
  }

  @keyframes fadeDown {
    from { opacity: 0; transform: translateY(-12px); }
    to { opacity: 1; transform: translateY(0); }
  }

  header h1 {
    font-family: var(--mono);
    font-size: 1.8rem;
    font-weight: 700;
    letter-spacing: -0.5px;
    margin-bottom: 0.4rem;
  }

  header h1 .py { color: var(--py-color); }
  header h1 .json { color: var(--json-color); }
  header h1 .arrow { color: var(--text-dim); margin: 0 0.15em; }

  header p {
    color: var(--text-dim);
    font-size: 0.9rem;
  }

  .converter {
    width: 100%;
    max-width: 1100px;
    display: grid;
    grid-template-columns: 1fr auto 1fr;
    gap: 0;
    align-items: stretch;
    animation: fadeUp 0.5s ease-out 0.1s both;
  }

  @keyframes fadeUp {
    from { opacity: 0; transform: translateY(12px); }
    to { opacity: 1; transform: translateY(0); }
  }

  .panel {
    background: var(--surface);
    border: 1px solid var(--border);
    display: flex;
    flex-direction: column;
    overflow: hidden;
  }

  .panel:first-child {
    border-radius: var(--radius) 0 0 var(--radius);
    border-right: none;
  }

  .panel:last-child {
    border-radius: 0 var(--radius) var(--radius) 0;
    border-left: none;
  }

  .panel-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 0.85rem 1.1rem;
    border-bottom: 1px solid var(--border);
    flex-shrink: 0;
  }

  .panel-label {
    font-family: var(--mono);
    font-size: 0.75rem;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 1.2px;
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }

  .panel:first-child .panel-label .dot { background: var(--py-color); }
  .panel:last-child .panel-label .dot { background: var(--json-color); }

  .dot {
    width: 8px;
    height: 8px;
    border-radius: 50%;
    display: inline-block;
  }

  .panel-actions {
    display: flex;
    gap: 0.4rem;
  }

  .btn-small {
    font-family: var(--mono);
    font-size: 0.68rem;
    padding: 0.3rem 0.65rem;
    border-radius: 6px;
    border: 1px solid var(--border);
    background: transparent;
    color: var(--text-dim);
    cursor: pointer;
    transition: all 0.15s;
    letter-spacing: 0.3px;
  }

  .btn-small:hover {
    background: var(--surface-hover);
    color: var(--text);
    border-color: var(--text-dim);
  }

  .btn-small.copied {
    border-color: var(--accent-green);
    color: var(--accent-green);
  }

  textarea {
    font-family: var(--mono);
    font-size: 0.85rem;
    line-height: 1.65;
    background: transparent;
    color: var(--text);
    border: none;
    outline: none;
    resize: none;
    padding: 1rem 1.1rem;
    flex: 1;
    min-height: 380px;
    tab-size: 2;
  }

  textarea::placeholder {
    color: var(--text-dim);
    opacity: 0.6;
  }

  textarea::-webkit-scrollbar { width: 6px; }
  textarea::-webkit-scrollbar-track { background: transparent; }
  textarea::-webkit-scrollbar-thumb { background: var(--border); border-radius: 3px; }

  .middle-col {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 0.7rem;
    padding: 0 0.3rem;
    z-index: 2;
  }

  .convert-btn {
    width: 46px;
    height: 46px;
    border-radius: 50%;
    border: 1px solid var(--border);
    background: var(--surface);
    color: var(--text-dim);
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.2s;
    box-shadow: var(--shadow);
  }

  .convert-btn:hover {
    border-color: var(--accent-blue);
    color: var(--accent-blue);
    transform: scale(1.08);
  }

  .convert-btn:active {
    transform: scale(0.96);
  }

  .convert-btn svg {
    width: 18px;
    height: 18px;
    fill: none;
    stroke: currentColor;
    stroke-width: 2;
    stroke-linecap: round;
    stroke-linejoin: round;
  }

  .status-bar {
    width: 100%;
    max-width: 1100px;
    margin-top: 0.8rem;
    animation: fadeUp 0.5s ease-out 0.2s both;
  }

  .status-msg {
    font-family: var(--mono);
    font-size: 0.75rem;
    padding: 0.6rem 1rem;
    border-radius: 8px;
    background: var(--surface);
    border: 1px solid var(--border);
    color: var(--text-dim);
    min-height: 2.2rem;
    display: flex;
    align-items: center;
    gap: 0.5rem;
    transition: all 0.2s;
  }

  .status-msg.error {
    border-color: rgba(248,113,113,0.3);
    color: var(--accent-red);
    background: rgba(248,113,113,0.05);
  }

  .status-msg.success {
    border-color: rgba(74,222,128,0.3);
    color: var(--accent-green);
    background: rgba(74,222,128,0.05);
  }

  .examples {
    width: 100%;
    max-width: 1100px;
    margin-top: 1.5rem;
    animation: fadeUp 0.5s ease-out 0.3s both;
  }

  .examples summary {
    font-family: var(--mono);
    font-size: 0.72rem;
    color: var(--text-dim);
    cursor: pointer;
    text-transform: uppercase;
    letter-spacing: 1px;
    padding: 0.5rem 0;
    user-select: none;
  }

  .examples summary:hover { color: var(--text); }

  .example-chips {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
    margin-top: 0.7rem;
  }

  .chip {
    font-family: var(--mono);
    font-size: 0.72rem;
    padding: 0.45rem 0.85rem;
    border-radius: 8px;
    border: 1px solid var(--border);
    background: var(--surface);
    color: var(--text-dim);
    cursor: pointer;
    transition: all 0.15s;
  }

  .chip:hover {
    background: var(--surface-hover);
    color: var(--text);
    border-color: var(--text-dim);
  }

  @media (max-width: 700px) {
    .converter {
      grid-template-columns: 1fr;
      gap: 0;
    }
    .panel:first-child {
      border-radius: var(--radius) var(--radius) 0 0;
      border-right: 1px solid var(--border);
      border-bottom: none;
    }
    .panel:last-child {
      border-radius: 0 0 var(--radius) var(--radius);
      border-left: 1px solid var(--border);
      border-top: none;
    }
    .middle-col {
      flex-direction: row;
      padding: 0.3rem 0;
    }
    textarea { min-height: 220px; }
  }
</style>
</head>
<body>

<header>
  <h1><span class="py">dict</span><span class="arrow"> ⇄ </span><span class="json">json</span></h1>
  <p>Convert between Python dict literals and JSON</p>
</header>

<div class="converter">
  <!-- Left: Python Dict -->
  <div class="panel">
    <div class="panel-header">
      <span class="panel-label"><span class="dot"></span> Python Dict</span>
      <div class="panel-actions">
        <button class="btn-small" onclick="clearPanel('input')">Clear</button>
        <button class="btn-small" id="copy-input" onclick="copyText('input')">Copy</button>
      </div>
    </div>
    <textarea id="input" spellcheck="false" placeholder="{'key': 'value', 'nested': {'a': True, 'b': None}}"></textarea>
  </div>

  <!-- Middle: Convert buttons -->
  <div class="middle-col">
    <button class="convert-btn" title="Python → JSON" onclick="convertToJSON()">
      <svg viewBox="0 0 24 24"><path d="M5 12h14M13 6l6 6-6 6"/></svg>
    </button>
    <button class="convert-btn" title="JSON → Python" onclick="convertToDict()">
      <svg viewBox="0 0 24 24"><path d="M19 12H5M11 18l-6-6 6-6"/></svg>
    </button>
  </div>

  <!-- Right: JSON -->
  <div class="panel">
    <div class="panel-header">
      <span class="panel-label"><span class="dot"></span> JSON</span>
      <div class="panel-actions">
        <button class="btn-small" onclick="clearPanel('output')">Clear</button>
        <button class="btn-small" id="copy-output" onclick="copyText('output')">Copy</button>
      </div>
    </div>
    <textarea id="output" spellcheck="false" placeholder='{"key": "value", "nested": {"a": true, "b": null}}'></textarea>
  </div>
</div>

<div class="status-bar">
  <div class="status-msg" id="status">Paste a Python dict or JSON and click an arrow to convert</div>
</div>

<details class="examples">
  <summary>▸ Example snippets</summary>
  <div class="example-chips">
    <button class="chip" onclick="loadExample(0)">Basic dict</button>
    <button class="chip" onclick="loadExample(1)">Nested + booleans</button>
    <button class="chip" onclick="loadExample(2)">Tuples & sets</button>
    <button class="chip" onclick="loadExample(3)">Single quotes</button>
    <button class="chip" onclick="loadExample(4)">JSON sample</button>
  </div>
</details>

<script>
const examples = [
  { side: 'input', text: `{'name': 'Alice', 'age': 30, 'active': True}` },
  { side: 'input', text: `{
  'user': {
    'id': 42,
    'admin': False,
    'bio': None,
    'tags': ['dev', 'python']
  }
}` },
  { side: 'input', text: `{
  'coords': (10, 20),
  'ids': {1, 2, 3},
  'label': 'test'
}` },
  { side: 'input', text: `{'message': "it's a quote", 'path': 'C:\\\\Users\\\\dan'}` },
  { side: 'output', text: `{
  "colors": ["red", "green", "blue"],
  "count": 3,
  "metadata": {
    "source": "api",
    "valid": true,
    "error": null
  }
}` },
];

function loadExample(i) {
  const ex = examples[i];
  document.getElementById(ex.side).value = ex.text;
  setStatus('Example loaded — click an arrow to convert', 'success');
}

function setStatus(msg, type = '') {
  const el = document.getElementById('status');
  el.textContent = msg;
  el.className = 'status-msg' + (type ? ' ' + type : '');
}

// Python dict → JSON
function convertToJSON() {
  const raw = document.getElementById('input').value.trim();
  if (!raw) { setStatus('Left panel is empty', 'error'); return; }

  try {
    const json = pythonDictToJSON(raw);
    const parsed = JSON.parse(json); // validate
    const pretty = JSON.stringify(parsed, null, 2);
    document.getElementById('output').value = pretty;
    setStatus(`Converted Python → JSON  (${pretty.length} chars)`, 'success');
  } catch (e) {
    setStatus('Error: ' + e.message, 'error');
  }
}

// JSON → Python dict
function convertToDict() {
  const raw = document.getElementById('output').value.trim();
  if (!raw) { setStatus('Right panel is empty', 'error'); return; }

  try {
    const parsed = JSON.parse(raw);
    const pyStr = jsonToPythonDict(parsed, 0);
    document.getElementById('input').value = pyStr;
    setStatus(`Converted JSON → Python  (${pyStr.length} chars)`, 'success');
  } catch (e) {
    setStatus('Error: ' + e.message, 'error');
  }
}

function pythonDictToJSON(s) {
  // Tokenize the Python dict string and rebuild as JSON
  let result = '';
  let i = 0;

  while (i < s.length) {
    const ch = s[i];

    // Handle strings (single or double quoted, including triple-quoted)
    if (ch === "'" || ch === '"') {
      // Check for triple quotes
      if (s.slice(i, i + 3) === ch.repeat(3)) {
        const tripleQuote = ch.repeat(3);
        let j = i + 3;
        while (j < s.length && s.slice(j, j + 3) !== tripleQuote) {
          if (s[j] === '\\') j++;
          j++;
        }
        let content = s.slice(i + 3, j);
        // Escape for JSON
        content = content.replace(/\\/g, '\\\\').replace(/"/g, '\\"').replace(/\n/g, '\\n').replace(/\r/g, '\\r').replace(/\t/g, '\\t');
        result += '"' + content + '"';
        i = j + 3;
        continue;
      }

      const quote = ch;
      let j = i + 1;
      let str = '';
      while (j < s.length && s[j] !== quote) {
        if (s[j] === '\\') {
          str += s[j] + s[j + 1];
          j += 2;
        } else {
          str += s[j];
          j++;
        }
      }
      // Convert single-quoted to double-quoted
      if (quote === "'") {
        // Unescape \' and escape "
        str = str.replace(/\\'/g, "'").replace(/"/g, '\\"');
      }
      result += '"' + str + '"';
      i = j + 1;
      continue;
    }

    // Handle Python keywords
    if (s.slice(i, i + 4) === 'True' && !isAlnum(s[i + 4])) {
      result += 'true'; i += 4; continue;
    }
    if (s.slice(i, i + 5) === 'False' && !isAlnum(s[i + 5])) {
      result += 'false'; i += 5; continue;
    }
    if (s.slice(i, i + 4) === 'None' && !isAlnum(s[i + 4])) {
      result += 'null'; i += 4; continue;
    }

    // Handle tuples (parentheses → arrays)
    if (ch === '(') { result += '['; i++; continue; }
    if (ch === ')') { result += ']'; i++; continue; }

    // Handle sets {1, 2, 3} — detected as braces without colons at current level
    // We'll just pass through and let JSON.parse validate

    // Handle Python comments
    if (ch === '#') {
      while (i < s.length && s[i] !== '\n') i++;
      continue;
    }

    // Trailing commas: remove comma before } or ]
    if (ch === ',') {
      // Look ahead for closing bracket
      let k = i + 1;
      while (k < s.length && /\s/.test(s[k])) k++;
      if (k < s.length && (s[k] === '}' || s[k] === ']' || s[k] === ')')) {
        i++;
        continue;
      }
    }

    result += ch;
    i++;
  }

  return result;
}

function isAlnum(ch) {
  if (!ch) return false;
  return /[a-zA-Z0-9_]/.test(ch);
}

function jsonToPythonDict(val, indent) {
  const pad = '  '.repeat(indent);
  const padInner = '  '.repeat(indent + 1);

  if (val === null) return 'None';
  if (val === true) return 'True';
  if (val === false) return 'False';
  if (typeof val === 'number') return String(val);
  if (typeof val === 'string') {
    // Use single quotes, escape internal single quotes
    const escaped = val.replace(/\\/g, '\\\\').replace(/'/g, "\\'").replace(/\n/g, '\\n').replace(/\r/g, '\\r').replace(/\t/g, '\\t');
    return "'" + escaped + "'";
  }

  if (Array.isArray(val)) {
    if (val.length === 0) return '[]';
    const items = val.map(v => jsonToPythonDict(v, indent + 1));
    const oneLine = '[' + items.join(', ') + ']';
    if (oneLine.length < 60 && !oneLine.includes('\n')) return oneLine;
    return '[\n' + items.map(item => padInner + item).join(',\n') + ',\n' + pad + ']';
  }

  if (typeof val === 'object') {
    const keys = Object.keys(val);
    if (keys.length === 0) return '{}';
    const entries = keys.map(k => {
      const pyKey = jsonToPythonDict(k, indent + 1);
      const pyVal = jsonToPythonDict(val[k], indent + 1);
      return pyKey + ': ' + pyVal;
    });
    const oneLine = '{' + entries.join(', ') + '}';
    if (oneLine.length < 60 && !oneLine.includes('\n')) return oneLine;
    return '{\n' + entries.map(e => padInner + e).join(',\n') + ',\n' + pad + '}';
  }

  return String(val);
}

function clearPanel(id) {
  document.getElementById(id).value = '';
  setStatus('Cleared');
}

function copyText(id) {
  const text = document.getElementById(id).value;
  if (!text) return;
  navigator.clipboard.writeText(text).then(() => {
    const btn = document.getElementById('copy-' + id);
    btn.textContent = 'Copied!';
    btn.classList.add('copied');
    setTimeout(() => { btn.textContent = 'Copy'; btn.classList.remove('copied'); }, 1500);
  });
}

// Keyboard shortcuts
document.addEventListener('keydown', (e) => {
  if ((e.ctrlKey || e.metaKey) && e.key === 'Enter') {
    if (document.activeElement.id === 'input') convertToJSON();
    else if (document.activeElement.id === 'output') convertToDict();
  }
});
</script>
</body>
</html>
